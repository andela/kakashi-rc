language: node_js
node_js:
  - "7.4.0"
cache: 
  directories:
    - $HOME/.meteor
    - $HOME/.npm

before_cache:
    - rm -f $HOME/.meteor/log/*.log

services:
  - docker

before_install:
  - PATH=$PATH:$HOME/.meteor
  - if [ ! -e $HOME/.meteor/meteor ]; then curl https://install.meteor.com | sh; fi
  - npm i -g reaction-cli coveralls
  - meteor npm install

script: 
  - mkdir .coverage
  - reaction test

after_script:
  - cat .coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js || true